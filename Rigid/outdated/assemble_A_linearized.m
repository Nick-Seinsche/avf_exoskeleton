function [A, b0] = assemble_A_linearized(N, L, h, t11)
    ctr = 1; 
    A = sparse(12 * N * (N-1), 6 * L);
    b0 = zeros(12 * N * (N-1), 1);
    for i = 1:N 
        for j = 1:N
            if i < N
                A(ctr+0, 1+6*(j-1)+(i-1)*6*N+0) = 1;
                A(ctr+0, 1+6*(j-1)+i*6*N+0) = -1;
                b0(ctr+0) = -h;

                A(ctr+1, 1+6*(j-1)+(i-1)*6*N+1) = 1;
                A(ctr+1, 1+6*(j-1)+(i-1)*6*N+3+0) = -0.5 * h;
                A(ctr+1, 1+6*(j-1)+i *6* N+1) = -1;
                A(ctr+1, 1+6*(j-1)+i *6*N+3+0) = -0.5 * h;

                A(ctr+2, 1+6*(j-1)+(i-1)*6*N+2) = 1;
                A(ctr+2, 1+6*(j-1)+(i-1)* 6 * N+3+1) = -0.5 * h;
                A(ctr+2, 1+6*(j-1)+i * 6 * N+2) = -1;
                A(ctr+2, 1+6*(j-1)+i * 6 * N+3+1) = -0.5 * h;

                ctr = ctr + 3;
            end
            if j < N
                A(ctr+0, 1+6*(j-1)+(i-1)*6*N) = 1;
                A(ctr+0, 1+6*j+(i-1)*6*N) = -1;
                A(ctr+0, 1+6*(j-1)+(i-1)*6*N+3) = 0.5 * h;
                A(ctr+0, 1+6*j+(i-1)*6*N+3) = 0.5 * h;

                A(ctr+1, 1+6*(j-1)+(i-1)*6*N+1) = 1;
                A(ctr+1, 1+6*j+(i-1)*6*N+1) = -1;
                b0(ctr+1) = -h;

                A(ctr+2, 1+6*(j-1)+(i-1)*6*N+2) = 1;
                A(ctr+2, 1+6*j+(i-1)*6*N+2) = -1;
                A(ctr+2, 1+6*(j-1)+(i-1)*6*N+5) = -0.5 * h;
                A(ctr+2, 1+6*j+(i-1)*6*N+5) = -0.5 * h;
                ctr = ctr + 3;
            end
            if i < N
                tij = vertcat((-1)^(i+j) * t11(1:2), t11(3));
                v = [0, -tij(2), tij(3)];  
                A(ctr+0, 1+6*(j-1)+(i-1)*6*N+3) = v * [0;1;0];
                A(ctr+0, 1+6*(j-1)+(i-1)*6*N+4) = v * [0;0;1];
                A(ctr+0, 1+6*(j-1)+(i-0)*6*N+3) = -v * [0;1;0];
                A(ctr+0, 1+6*(j-1)+(i-0)*6*N+4) = -v * [0;0;1];

                A(ctr+1, 1+6*(j-1)+(i-1)*6*N+3) = -v * [1;0;0];
                A(ctr+1, 1+6*(j-1)+(i-1)*6*N+5) = v * [0;0;1];
                A(ctr+1, 1+6*(j-1)+(i-0)*6*N+3) = v * [1;0;0];
                A(ctr+1, 1+6*(j-1)+(i-0)*6*N+5) = -v * [0;0;1];

                A(ctr+2, 1+6*(j-1)+(i-1)*6*N+4) = -v * [1;0;0];
                A(ctr+2, 1+6*(j-1)+(i-1)*6*N+5) = -v * [0;1;0];
                A(ctr+2, 1+6*(j-1)+(i-0)*6*N+4) = v * [1;0;0];
                A(ctr+2, 1+6*(j-1)+(i-0)*6*N+5) = v * [0;1;0]; 
                ctr = ctr + 3;
            end
            if j < N
                tij = vertcat((-1)^(i+j) * t11(1:2), t11(3));
                v = [-tij(1), 0, tij(3)];

                A(ctr+0, 1+6*(j-1)+(i-1)*6*N+3) = v * [0;1;0];
                A(ctr+0, 1+6*(j-1)+(i-1)*6*N+4) = v * [0;0;1];
                A(ctr+0, 1+6*(j-0)+(i-1)*6*N+3) = -v * [0;1;0];
                A(ctr+0, 1+6*(j-0)+(i-1)*6*N+4) = -v * [0;0;1];

                A(ctr+1, 1+6*(j-1)+(i-1)*6*N+3) = -v * [1;0;0];
                A(ctr+1, 1+6*(j-1)+(i-1)*6*N+5) = v * [0;0;1];
                A(ctr+1, 1+6*(j-0)+(i-1)*6*N+3) = v * [1;0;0];
                A(ctr+1, 1+6*(j-0)+(i-1)*6*N+5) = -v * [0;0;1];

                A(ctr+2, 1+6*(j-1)+(i-1)*6*N+4) = -v * [1;0;0];
                A(ctr+2, 1+6*(j-1)+(i-1)*6*N+5) = -v * [0;1;0];
                A(ctr+2, 1+6*(j-0)+(i-1)*6*N+4) = v * [1;0;0];
                A(ctr+2, 1+6*(j-0)+(i-1)*6*N+5) = v * [0;1;0];
                ctr = ctr + 3;
            end
        end
    end
end